<!DOCTYPE html>
<html lang="hu" data-theme="light">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BotiX - Prémium Cipőbolt | Nike, Jordan, Adidas, Vans</title>
    <meta name="description" content="BotiX prémium cipőbolt - Eredeti Nike, Jordan, Adidas és Vans cipők széles választéka. Gyors szállítás, megbízható minőség.">
    <meta name="keywords" content="cipő, sneaker, Nike, Jordan, Adidas, Vans, prémium cipő, eredeti cipő, cipőbolt, BotiX">
    <meta name="author" content="BotiX">
    <meta name="robots" content="index, follow">
    <link rel="canonical" href="https://botix.hu/">
    <link rel="icon" type="image/svg+xml" href="/favicon.svg">
    <!-- Open Graph -->
    <meta property="og:type" content="website">
    <meta property="og:title" content="BotiX - Prémium Cipőbolt">
    <meta property="og:description" content="Eredeti Nike, Jordan, Adidas és Vans cipők széles választéka. Gyors szállítás, megbízható minőség.">
    <meta property="og:url" content="https://botix.hu/">
    <meta property="og:site_name" content="BotiX">
    <meta property="og:locale" content="hu_HU">
    <meta property="og:image" content="https://botix.hu/og-image.png">
    <meta property="og:image:width" content="1200">
    <meta property="og:image:height" content="630">
    <!-- Twitter Card -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="BotiX - Prémium Cipőbolt">
    <meta name="twitter:description" content="Eredeti Nike, Jordan, Adidas és Vans cipők széles választéka.">
    <meta name="twitter:image" content="https://botix.hu/og-image.png">
    <!-- JSON-LD Structured Data -->
    <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "Store",
        "name": "BotiX",
        "description": "Prémium cipőbolt - Eredeti Nike, Jordan, Adidas és Vans cipők",
        "url": "https://botix.hu",
        "telephone": "+36304149661",
        "email": "info@botix.hu",
        "currenciesAccepted": "HUF, EUR",
        "priceRange": "$$",
        "address": {
            "@type": "PostalAddress",
            "addressCountry": "HU"
        }
    }
    </script>
    <style>
        :root, [data-theme="dark"] {
            --primary: #0a0a0a;
            --accent: #ff4d00;
            --accent-hover: #e64500;
            --bg: #050505;
            --card-bg: #1a1a1a;
            --card-hover: #222222;
            --text: #eee;
            --text-muted: #8892a4;
            --border: #2a2a2a;
            --success: #00d68f;
            --badge-jordan: #c9302c;
            --badge-nike: #f37021;
            --badge-adidas: #1d1d1b;
            --badge-vans: #c1272d;
            --header-start: #0a0a0a;
            --header-end: #1a1a1a;
            --overlay-subtle: rgba(255,255,255,0.04);
            --overlay-light: rgba(255,255,255,0.06);
            --overlay-medium: rgba(255,255,255,0.08);
            --overlay-strong: rgba(255,255,255,0.12);
            --shadow-card: rgba(0,0,0,0.3);
            --modal-overlay: rgba(0,0,0,0.7);
            --cart-overlay: rgba(0,0,0,0.5);
            --badge-adidas-border: #555;
            --scrollbar-thumb: #2a2a2a;
            --scrollbar-hover: #8892a4;
        }

        [data-theme="light"] {
            --primary: #ffffff;
            --bg: #f0f2f5;
            --card-bg: #ffffff;
            --card-hover: #f8f9fa;
            --text: #0a0a0a;
            --text-muted: #6b7280;
            --border: #dde1e7;
            --header-start: #ffffff;
            --header-end: #f5f6f8;
            --overlay-subtle: rgba(0,0,0,0.02);
            --overlay-light: rgba(0,0,0,0.04);
            --overlay-medium: rgba(0,0,0,0.05);
            --overlay-strong: rgba(0,0,0,0.08);
            --shadow-card: rgba(0,0,0,0.08);
            --modal-overlay: rgba(0,0,0,0.4);
            --cart-overlay: rgba(0,0,0,0.3);
            --badge-adidas: #333;
            --badge-adidas-border: #888;
            --scrollbar-thumb: #ccc;
            --scrollbar-hover: #999;
        }

        * { margin: 0; padding: 0; box-sizing: border-box; }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, sans-serif;
            background: var(--bg);
            color: var(--text);
            min-height: 100vh;
            transition: background 0.3s, color 0.3s;
        }

        header {
            background: linear-gradient(135deg, var(--header-start) 0%, var(--header-end) 100%);
            border-bottom: 1px solid var(--border);
            position: sticky;
            top: 0;
            z-index: 100;
            backdrop-filter: blur(20px);
            transition: background 0.3s, border-color 0.3s;
        }

        .header-top {
            max-width: 1400px;
            margin: 0 auto;
            padding: 16px 20px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            gap: 16px;
        }

        .logo-group { display: flex; align-items: center; gap: 12px; white-space: nowrap; }
        .logo { font-size: 24px; font-weight: 800; letter-spacing: -0.5px; white-space: nowrap; }
        .logo span { color: var(--accent); }
        .logo-slogan { font-size: 12px; color: var(--text-muted); letter-spacing: 1px; text-transform: uppercase; font-weight: 600; }
        .logo-badge { display: inline-flex; align-items: center; gap: 4px; background: linear-gradient(135deg, #ff4d00, #ff8533); color: #fff; font-size: 10px; font-weight: 800; letter-spacing: 1px; text-transform: uppercase; padding: 3px 10px; border-radius: 4px; }
        .logo-badge svg { flex-shrink: 0; }

        .search-container { flex: 1; max-width: 500px; position: relative; }

        .search-container input {
            width: 100%;
            padding: 12px 16px 12px 44px;
            background: var(--overlay-medium);
            border: 1px solid var(--border);
            border-radius: 12px;
            color: var(--text);
            font-size: 15px;
            outline: none;
            transition: all 0.3s;
        }

        .search-container input:focus {
            border-color: var(--accent);
            background: var(--overlay-strong);
            box-shadow: 0 0 0 3px rgba(255,77,0,0.15);
        }

        .search-container input::placeholder { color: var(--text-muted); }

        .search-icon {
            position: absolute;
            left: 14px;
            top: 50%;
            transform: translateY(-50%);
            color: var(--text-muted);
            pointer-events: none;
        }

        .header-actions { display: flex; align-items: center; gap: 10px; }
        .settings-toggles { display: flex; gap: 6px; align-items: center; }

        .toggle-group {
            display: flex;
            border: 1px solid var(--border);
            border-radius: 8px;
            overflow: hidden;
            transition: border-color 0.3s;
        }

        .toggle-opt {
            padding: 6px 10px;
            background: transparent;
            border: none;
            color: var(--text-muted);
            font-size: 11px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
            letter-spacing: 0.3px;
        }

        .toggle-opt:hover { color: var(--text); }
        .toggle-opt.active { background: var(--accent); color: white; }

        .cart-btn {
            position: relative;
            background: none;
            border: 2px solid var(--border);
            color: var(--text);
            padding: 10px 14px;
            border-radius: 12px;
            cursor: pointer;
            font-size: 20px;
            transition: all 0.3s;
        }

        .cart-btn:hover { border-color: var(--accent); color: var(--accent); }

        .cart-count {
            position: absolute;
            top: -6px;
            right: -6px;
            background: var(--accent);
            color: white;
            font-size: 11px;
            font-weight: 700;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .slogan-bar {
            text-align: center;
            padding: 10px 20px;
            background: linear-gradient(135deg, var(--header-start), var(--header-end));
            border-bottom: 1px solid var(--border);
            font-size: 13px;
            color: var(--text-muted);
            letter-spacing: 1.5px;
            text-transform: uppercase;
            font-weight: 600;
        }

        .filters-section { max-width: 1400px; margin: 0 auto; padding: 20px 20px 0; }
        .filter-row { display: flex; gap: 10px; flex-wrap: wrap; align-items: center; }
        .filter-group { display: flex; gap: 8px; flex-wrap: wrap; }

        .filter-btn {
            padding: 8px 18px;
            border-radius: 24px;
            border: 1px solid var(--border);
            background: transparent;
            color: var(--text-muted);
            font-size: 13px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s;
            white-space: nowrap;
        }

        .filter-btn:hover { border-color: var(--accent); color: var(--text); }
        .filter-btn.active { background: var(--accent); border-color: var(--accent); color: white; }

        .filter-label {
            font-size: 13px;
            color: var(--text-muted);
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            padding: 8px 4px;
        }

        .filter-divider { width: 1px; height: 28px; background: var(--border); margin: 0 8px; }

        .size-filters { display: flex; gap: 6px; flex-wrap: wrap; margin-top: 12px; }

        .size-btn {
            width: 44px;
            height: 36px;
            border-radius: 8px;
            border: 1px solid var(--border);
            background: transparent;
            color: var(--text-muted);
            font-size: 12px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
        }

        .size-btn:hover { border-color: var(--accent); color: var(--text); }
        .size-btn.active { background: var(--accent); border-color: var(--accent); color: white; }

        .results-count { font-size: 14px; color: var(--text-muted); padding: 16px 0 4px; }
        .results-count strong { color: var(--text); }

        .sort-row { display: flex; justify-content: space-between; align-items: center; margin-top: 8px; }

        .sort-select {
            padding: 8px 12px;
            background: var(--overlay-light);
            border: 1px solid var(--border);
            border-radius: 8px;
            color: var(--text);
            font-size: 13px;
            cursor: pointer;
        }

        .sort-select option { background: var(--primary); color: var(--text); }

        .products-grid {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 20px;
        }

        .product-card {
            background: var(--card-bg);
            border-radius: 16px;
            overflow: hidden;
            border: 1px solid var(--border);
            transition: all 0.3s ease;
            cursor: pointer;
            position: relative;
        }

        .product-card:hover {
            transform: translateY(-4px);
            border-color: rgba(255,77,0,0.3);
            box-shadow: 0 12px 40px var(--shadow-card);
        }

        .product-image {
            aspect-ratio: 4/3;
            position: relative;
            overflow: hidden;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .product-image img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            transition: transform 0.4s ease;
        }

        .product-card:hover .product-image img { transform: scale(1.06); }

        .brand-badge {
            position: absolute;
            top: 12px;
            left: 12px;
            padding: 4px 10px;
            border-radius: 6px;
            font-size: 11px;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            color: white;
        }

        .brand-badge.jordan { background: var(--badge-jordan); }
        .brand-badge.nike { background: var(--badge-nike); }
        .brand-badge.adidas { background: var(--badge-adidas); border: 1px solid var(--badge-adidas-border); }
        .brand-badge.vans { background: var(--badge-vans); }

        .type-badge {
            position: absolute;
            top: 12px;
            right: 12px;
            padding: 4px 8px;
            border-radius: 6px;
            font-size: 10px;
            font-weight: 600;
            background: rgba(0,0,0,0.5);
            color: white;
            backdrop-filter: blur(4px);
        }

        .sale-badge {
            position: absolute;
            bottom: 12px;
            left: 12px;
            padding: 4px 10px;
            border-radius: 6px;
            font-size: 11px;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            color: white;
            background: #e53e3e;
            z-index: 2;
        }

        .sale-percent-badge {
            position: absolute;
            bottom: 12px;
            right: 12px;
            padding: 4px 8px;
            border-radius: 6px;
            font-size: 11px;
            font-weight: 700;
            color: white;
            background: #e53e3e;
            z-index: 2;
        }

        .original-price {
            text-decoration: line-through;
            color: var(--text-muted);
            font-size: 14px;
            font-weight: 500;
            margin-right: 6px;
        }

        .sale-price {
            color: var(--accent);
            font-weight: 800;
        }

        .product-info { padding: 16px; }
        .product-name { font-size: 15px; font-weight: 700; margin-bottom: 4px; line-height: 1.3; }
        .product-colorway { font-size: 13px; color: var(--text-muted); margin-bottom: 10px; }
        .product-meta { display: flex; gap: 12px; flex-wrap: wrap; margin-bottom: 12px; }
        .meta-tag { font-size: 11px; padding: 3px 8px; border-radius: 4px; background: var(--overlay-light); color: var(--text-muted); }

        .product-bottom {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding-top: 12px;
            border-top: 1px solid var(--border);
        }

        .product-price { font-size: 22px; font-weight: 800; color: var(--accent); }
        .product-price .currency { font-size: 14px; font-weight: 600; }

        .add-to-cart {
            padding: 10px 20px;
            background: var(--accent);
            color: white;
            border: none;
            border-radius: 10px;
            font-size: 13px;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.2s;
        }

        .add-to-cart:hover { background: var(--accent-hover); transform: scale(1.05); }
        .add-to-cart:active { transform: scale(0.98); }

        .modal-overlay {
            display: none;
            position: fixed;
            inset: 0;
            background: var(--modal-overlay);
            z-index: 200;
            align-items: center;
            justify-content: center;
            padding: 20px;
            backdrop-filter: blur(4px);
        }

        .modal-overlay.show { display: flex; }

        .modal {
            background: var(--card-bg);
            border-radius: 20px;
            max-width: 800px;
            width: 100%;
            max-height: 90vh;
            overflow-y: auto;
            border: 1px solid var(--border);
            position: relative;
        }

        .modal-close {
            position: absolute;
            top: 16px;
            right: 16px;
            background: var(--overlay-strong);
            border: none;
            color: var(--text);
            width: 36px;
            height: 36px;
            border-radius: 50%;
            font-size: 18px;
            cursor: pointer;
            z-index: 10;
            transition: all 0.2s;
        }

        .modal-close:hover { background: var(--accent); color: white; }

        .modal-image {
            padding: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            min-height: 300px;
        }

        .modal-image img { max-width: 100%; max-height: 350px; object-fit: contain; border-radius: 12px; }

        .modal-gallery { position: relative; padding: 20px 40px; }

        .gallery-main {
            display: flex;
            align-items: center;
            justify-content: center;
            min-height: 300px;
            position: relative;
        }

        .gallery-main img { max-width: 100%; max-height: 350px; object-fit: contain; border-radius: 12px; }

        .gallery-nav {
            position: absolute;
            top: 50%;
            transform: translateY(-50%);
            background: var(--overlay-strong);
            border: 1px solid var(--border);
            color: var(--text);
            width: 40px;
            height: 40px;
            border-radius: 50%;
            font-size: 18px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s;
            z-index: 5;
        }

        .gallery-nav:hover { background: var(--accent); color: white; border-color: var(--accent); }
        .gallery-nav.prev { left: 8px; }
        .gallery-nav.next { right: 8px; }

        .gallery-thumbs {
            display: flex;
            gap: 8px;
            justify-content: center;
            padding: 12px 0 0;
            flex-wrap: wrap;
        }

        .gallery-thumb {
            width: 56px;
            height: 56px;
            border-radius: 8px;
            overflow: hidden;
            cursor: pointer;
            border: 2px solid var(--border);
            transition: border-color 0.2s;
            flex-shrink: 0;
        }

        .gallery-thumb.active { border-color: var(--accent); }
        .gallery-thumb img { width: 100%; height: 100%; object-fit: cover; display: block; }

        .modal-body { padding: 0 32px 32px; }
        .modal-body h2 { font-size: 24px; font-weight: 800; margin-bottom: 8px; }
        .modal-body .colorway { color: var(--text-muted); font-size: 15px; margin-bottom: 16px; }

        .modal-details {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(140px, 1fr));
            gap: 12px;
            margin-bottom: 20px;
        }

        .detail-item { background: var(--overlay-subtle); padding: 12px; border-radius: 10px; }
        .detail-item label { font-size: 11px; text-transform: uppercase; letter-spacing: 0.5px; color: var(--text-muted); display: block; margin-bottom: 4px; }
        .detail-item span { font-size: 16px; font-weight: 700; }
        .modal-price { font-size: 32px; font-weight: 800; color: var(--accent); margin-bottom: 20px; }

        .modal-add-btn {
            width: 100%;
            padding: 16px;
            background: var(--accent);
            color: white;
            border: none;
            border-radius: 12px;
            font-size: 16px;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.2s;
        }

        .modal-add-btn:hover { background: var(--accent-hover); }

        .cart-overlay {
            display: none;
            position: fixed;
            inset: 0;
            background: var(--cart-overlay);
            z-index: 300;
        }

        .cart-overlay.show { display: block; }

        .cart-drawer {
            position: fixed;
            top: 0;
            right: -400px;
            width: 380px;
            max-width: 90vw;
            height: 100vh;
            background: var(--primary);
            z-index: 301;
            transition: right 0.3s ease;
            display: flex;
            flex-direction: column;
            border-left: 1px solid var(--border);
        }

        .cart-drawer.open { right: 0; }

        .cart-header {
            padding: 20px;
            border-bottom: 1px solid var(--border);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .cart-header h3 { font-size: 18px; font-weight: 700; }
        .cart-close { background: none; border: none; color: var(--text-muted); font-size: 24px; cursor: pointer; }
        .cart-items { flex: 1; overflow-y: auto; padding: 16px; }

        .cart-item {
            display: flex;
            gap: 12px;
            padding: 12px;
            background: var(--overlay-subtle);
            border-radius: 12px;
            margin-bottom: 10px;
            position: relative;
        }

        .cart-item-img {
            width: 70px;
            height: 70px;
            border-radius: 8px;
            overflow: hidden;
            display: flex;
            align-items: center;
            justify-content: center;
            flex-shrink: 0;
        }

        .cart-item-img img { width: 100%; height: 100%; object-fit: cover; border-radius: 6px; }
        .cart-item-info { flex: 1; }
        .cart-item-info h4 { font-size: 13px; font-weight: 600; margin-bottom: 2px; }
        .cart-item-info .ci-size { font-size: 11px; color: var(--text-muted); }
        .cart-item-info .ci-price { font-size: 15px; font-weight: 700; color: var(--accent); margin-top: 4px; }

        .cart-item-remove {
            position: absolute;
            top: 8px;
            right: 8px;
            background: none;
            border: none;
            color: var(--text-muted);
            cursor: pointer;
            font-size: 16px;
        }

        .cart-item-remove:hover { color: var(--accent); }
        .cart-empty { text-align: center; color: var(--text-muted); padding: 40px 20px; font-size: 14px; }

        .cart-footer { padding: 20px; border-top: 1px solid var(--border); }

        .cart-total {
            display: flex;
            justify-content: space-between;
            margin-bottom: 16px;
            font-size: 18px;
            font-weight: 700;
        }

        .cart-total span:last-child { color: var(--accent); }

        .checkout-btn {
            width: 100%;
            padding: 14px;
            background: var(--accent);
            color: white;
            border: none;
            border-radius: 12px;
            font-size: 15px;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.2s;
        }

        .checkout-btn:hover { background: var(--accent-hover); }

        .no-results { grid-column: 1 / -1; text-align: center; padding: 60px 20px; }
        .no-results h3 { font-size: 20px; margin-bottom: 8px; }
        .no-results p { color: var(--text-muted); }

        .toast {
            position: fixed;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%) translateY(100px);
            background: var(--success);
            color: #000;
            padding: 12px 24px;
            border-radius: 12px;
            font-size: 14px;
            font-weight: 600;
            z-index: 400;
            transition: transform 0.3s ease;
            white-space: nowrap;
        }

        .toast.error { background: #e74c3c; color: white; }
        .toast.show { transform: translateX(-50%) translateY(0); }

        .auth-btn {
            background: none;
            border: 2px solid var(--border);
            color: var(--text);
            padding: 10px 14px;
            border-radius: 12px;
            cursor: pointer;
            font-size: 20px;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .auth-btn:hover { border-color: var(--accent); color: var(--accent); }

        .auth-btn .auth-name {
            font-size: 13px;
            font-weight: 600;
            max-width: 100px;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
        }

        .auth-modal-overlay {
            display: none;
            position: fixed;
            inset: 0;
            background: var(--modal-overlay);
            z-index: 500;
            align-items: center;
            justify-content: center;
            padding: 20px;
            backdrop-filter: blur(4px);
        }

        .auth-modal-overlay.show { display: flex; }

        .auth-modal {
            background: var(--card-bg);
            border-radius: 20px;
            max-width: 440px;
            width: 100%;
            padding: 32px;
            border: 1px solid var(--border);
            position: relative;
        }

        .auth-modal-close {
            position: absolute;
            top: 16px;
            right: 16px;
            background: var(--overlay-strong);
            border: none;
            color: var(--text);
            width: 36px;
            height: 36px;
            border-radius: 50%;
            font-size: 18px;
            cursor: pointer;
            z-index: 10;
            transition: all 0.2s;
        }

        .auth-modal-close:hover { background: var(--accent); color: white; }

        .auth-modal h2 { font-size: 22px; font-weight: 800; margin-bottom: 20px; }

        .auth-tabs {
            display: flex;
            gap: 4px;
            margin-bottom: 20px;
            border-bottom: 1px solid var(--border);
        }

        .auth-tab {
            padding: 10px 20px;
            background: none;
            border: none;
            border-bottom: 2px solid transparent;
            color: var(--text-muted);
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
        }

        .auth-tab:hover { color: var(--text); }
        .auth-tab.active { color: var(--accent); border-bottom-color: var(--accent); }

        .auth-form { display: none; }
        .auth-form.active { display: block; }

        .auth-form .form-group { margin-bottom: 14px; }

        .auth-form .form-label {
            display: block;
            font-size: 12px;
            font-weight: 600;
            color: var(--text-muted);
            margin-bottom: 5px;
            text-transform: uppercase;
            letter-spacing: 0.3px;
        }

        .auth-form .form-input {
            width: 100%;
            padding: 10px 12px;
            background: var(--overlay-medium);
            border: 1px solid var(--border);
            border-radius: 10px;
            color: var(--text);
            font-size: 14px;
            font-family: inherit;
            outline: none;
            transition: all 0.2s;
        }

        .auth-form .form-input:focus {
            border-color: var(--accent);
            box-shadow: 0 0 0 3px rgba(255,77,0,0.15);
        }

        .auth-form .form-row {
            display: grid;
            grid-template-columns: 120px 1fr;
            gap: 10px;
        }

        .auth-form .auth-submit {
            width: 100%;
            padding: 14px;
            background: var(--accent);
            color: white;
            border: none;
            border-radius: 12px;
            font-size: 15px;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.2s;
            margin-top: 4px;
        }

        .auth-form .auth-submit:hover { background: var(--accent-hover); }
        .auth-form .auth-submit:disabled { opacity: 0.5; cursor: not-allowed; }

        .auth-error {
            color: #e74c3c;
            font-size: 13px;
            font-weight: 600;
            margin-bottom: 10px;
            display: none;
        }

        .auth-error.show { display: block; }

        .user-menu {
            position: relative;
        }

        .user-dropdown {
            display: none;
            position: absolute;
            top: calc(100% + 8px);
            right: 0;
            background: var(--card-bg);
            border: 1px solid var(--border);
            border-radius: 12px;
            padding: 8px;
            min-width: 180px;
            box-shadow: 0 8px 24px var(--shadow-card);
            z-index: 200;
        }

        .user-dropdown.show { display: block; }

        .user-dropdown-item {
            display: block;
            width: 100%;
            padding: 10px 14px;
            background: none;
            border: none;
            color: var(--text);
            font-size: 13px;
            font-weight: 500;
            cursor: pointer;
            text-align: left;
            border-radius: 8px;
            transition: background 0.15s;
        }

        .user-dropdown-item:hover { background: var(--overlay-medium); }
        .user-dropdown-item.logout { color: #e74c3c; }

        footer {
            max-width: 1400px;
            margin: 0 auto;
            padding: 40px 20px;
            text-align: center;
            border-top: 1px solid var(--border);
            color: var(--text-muted);
            font-size: 13px;
        }

        .footer-contact {
            margin-bottom: 12px;
        }

        .footer-contact a {
            color: var(--accent);
            text-decoration: none;
            font-weight: 600;
            font-size: 14px;
            transition: opacity 0.2s;
        }

        .footer-contact a:hover { opacity: 0.8; }

        .footer-sep {
            color: var(--text-muted);
            margin: 0 10px;
            opacity: 0.4;
        }

        @media (max-width: 768px) {
            .header-top { flex-wrap: wrap; padding: 12px 16px; }
            .search-container { order: 3; flex-basis: 100%; max-width: 100%; }
            .header-actions { gap: 8px; }
            .settings-toggles { gap: 4px; }
            .toggle-opt { padding: 5px 7px; font-size: 10px; }
            .logo-slogan { display: none; }
            .stats { gap: 20px; }
            .products-grid { padding: 16px; gap: 14px; grid-template-columns: repeat(auto-fill, minmax(160px, 1fr)); }
            .product-info { padding: 12px; }
            .product-name { font-size: 13px; }
            .product-price { font-size: 18px; }
            .add-to-cart { padding: 8px 14px; font-size: 12px; }
            .filter-divider { display: none; }
            .modal-body { padding: 0 20px 20px; }
            .modal-image { padding: 20px; min-height: 200px; }
            .modal-image img { max-width: 200px; }
            .modal-gallery { padding: 16px 20px; }
            .gallery-main img { max-height: 220px; }
            .gallery-thumb { width: 44px; height: 44px; }
        }

        @media (max-width: 400px) {
            .products-grid { grid-template-columns: 1fr; }
        }

        ::-webkit-scrollbar { width: 6px; }
        ::-webkit-scrollbar-track { background: transparent; }
        ::-webkit-scrollbar-thumb { background: var(--scrollbar-thumb); border-radius: 3px; }
        ::-webkit-scrollbar-thumb:hover { background: var(--scrollbar-hover); }
    </style>
</head>
<body>

<header>
    <div class="header-top">
        <div class="logo-group">
            <div class="logo">Boti<span>X</span></div>
            <span class="logo-slogan" id="logoSlogan"></span>
            <span class="logo-badge"><svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="#fff" stroke-width="3" stroke-linecap="round" stroke-linejoin="round"><path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"/><polyline points="22 4 12 14.01 9 11.01"/></svg> <span id="logoBadge"></span></span>
        </div>
        <div class="search-container">
            <svg class="search-icon" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"><circle cx="11" cy="11" r="8"/><path d="m21 21-4.35-4.35"/></svg>
            <input type="text" id="searchInput">
        </div>
        <div class="header-actions">
            <div class="settings-toggles">
                <div class="toggle-group" id="themeToggle">
                    <button class="toggle-opt active" data-val="dark">Dark</button>
                    <button class="toggle-opt" data-val="light">Light</button>
                </div>
                <div class="toggle-group" id="langToggle">
                    <button class="toggle-opt active" data-val="hu">HU</button>
                    <button class="toggle-opt" data-val="en">EN</button>
                </div>
                <div class="toggle-group" id="currToggle">
                    <button class="toggle-opt active" data-val="HUF">HUF</button>
                    <button class="toggle-opt" data-val="EUR">EUR</button>
                </div>
            </div>
            <div class="user-menu" id="userMenu">
                <button class="auth-btn" id="authBtn" onclick="handleAuthClick()">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"><path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"/><circle cx="12" cy="7" r="4"/></svg>
                    <span class="auth-name" id="authName" style="display:none"></span>
                </button>
                <div class="user-dropdown" id="userDropdown">
                    <button class="user-dropdown-item" id="userEmail" disabled style="opacity:0.6;cursor:default"></button>
                    <a class="user-dropdown-item" id="myAccountLink" href="account.html" style="text-decoration:none;color:var(--text);display:block;text-align:left"></a>
                    <button class="user-dropdown-item logout" id="logoutBtn" onclick="doLogout()"></button>
                </div>
            </div>
            <button class="cart-btn" onclick="toggleCart()">
                <svg width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M6 2L3 6v14a2 2 0 002 2h14a2 2 0 002-2V6l-3-4z"/><line x1="3" y1="6" x2="21" y2="6"/><path d="M16 10a4 4 0 01-8 0"/></svg>
                <div class="cart-count" id="cartCount" style="display:none">0</div>
            </button>
        </div>
    </div>
</header>

<div class="slogan-bar">
    <span id="sloganText"></span>
</div>

<section class="filters-section">
    <div class="filter-row" id="filterRow"></div>
    <div class="size-filters" id="sizeFilters"></div>
    <div class="active-filters" id="activeFilters"></div>
    <div class="sort-row">
        <div class="results-count" id="resultsCount"></div>
        <select class="sort-select" id="sortSelect"></select>
    </div>
</section>

<main class="products-grid" id="productsGrid"></main>

<footer>
    <div class="footer-contact">
        <a href="mailto:info@botix.hu">info@botix.hu</a>
        <span class="footer-sep">|</span>
        <a href="tel:+36304149661">+36 30 414 9661</a>
    </div>
    <p id="footerText"></p>
    <p style="margin-top: 8px"><a href="admin.html" style="color: var(--text-muted); font-size: 12px; text-decoration: none; opacity: 0.5;">Admin</a></p>
</footer>

<div class="modal-overlay" id="productModal">
    <div class="modal" id="modalContent"></div>
</div>

<div class="cart-overlay" id="cartOverlay" onclick="toggleCart()"></div>
<div class="cart-drawer" id="cartDrawer">
    <div class="cart-header">
        <h3 id="cartTitle"></h3>
        <button class="cart-close" onclick="toggleCart()">&times;</button>
    </div>
    <div class="cart-items" id="cartItems"></div>
    <div class="cart-footer">
        <div class="cart-total">
            <span id="cartTotalLabel"></span>
            <span id="cartTotal"></span>
        </div>
        <button class="checkout-btn" id="checkoutBtn" onclick="checkout()"></button>
    </div>
</div>

<div class="auth-modal-overlay" id="authModal">
    <div class="auth-modal">
        <button class="auth-modal-close" onclick="closeAuthModal()">&times;</button>
        <div class="auth-tabs">
            <button class="auth-tab active" data-auth="login" id="authTabLogin"></button>
            <button class="auth-tab" data-auth="register" id="authTabRegister"></button>
        </div>
        <div class="auth-error" id="authError"></div>
        <form class="auth-form active" id="loginForm" onsubmit="doLogin(event)">
            <div class="form-group">
                <label class="form-label">Email *</label>
                <input class="form-input" type="email" id="loginEmail" required>
            </div>
            <div class="form-group">
                <label class="form-label" id="loginPassLabel"></label>
                <input class="form-input" type="password" id="loginPassword" required>
            </div>
            <button type="submit" class="auth-submit" id="loginSubmitBtn"></button>
        </form>
        <form class="auth-form" id="registerForm" onsubmit="doRegister(event)">
            <div class="form-group">
                <label class="form-label">Email *</label>
                <input class="form-input" type="email" id="regEmail" required>
            </div>
            <div class="form-group">
                <label class="form-label" id="regPassLabel"></label>
                <input class="form-input" type="password" id="regPassword" minlength="6" required>
            </div>
            <div class="form-group">
                <label class="form-label" id="regNameLabel"></label>
                <input class="form-input" type="text" id="regName" required>
            </div>
            <div class="form-group">
                <label class="form-label" id="regPhoneLabel"></label>
                <input class="form-input" type="tel" id="regPhone">
            </div>
            <div class="form-group">
                <label class="form-label" id="regAddressLabel"></label>
                <div class="form-row">
                    <input class="form-input" type="text" id="regZip" placeholder="">
                    <input class="form-input" type="text" id="regCity" placeholder="">
                </div>
            </div>
            <div class="form-group">
                <label class="form-label" id="regStreetLabel"></label>
                <input class="form-input" type="text" id="regStreet">
            </div>
            <button type="submit" class="auth-submit" id="regSubmitBtn"></button>
        </form>
    </div>
</div>

<div class="toast" id="toast"></div>

<script>
const i18n = {
    hu: {
        searchPlaceholder: 'Keresés modell, szín, méret alapján...',
        heroTitle: 'Lépj szintet!',
        heroDesc: 'Eredeti Nike, Jordan, Adidas és Vans cipők. Minden darab 100% eredeti, dobozos.',
        ribbonText: '100% Eredeti',
        logoSlogan: 'Prémium cipőbolt',
        logoBadge: '100% Eredeti',
        brandLabel: 'Márka:',
        typeLabel: 'Típus:',
        genderLabel: 'Nem:',
        sizeLabel: 'EUR méret:',
        all: 'Mind',
        men: 'Férfi',
        women: 'Női',
        gsYouth: 'GS/Youth',
        sortName: 'Név szerint',
        sortPriceAsc: 'Ár: alacsony → magas',
        sortPriceDesc: 'Ár: magas → alacsony',
        sortSizeAsc: 'Méret: kicsi → nagy',
        sortSizeDesc: 'Méret: nagy → kicsi',
        resultsCount: (n) => `<strong>${n}</strong> termék található`,
        noResults: 'Nincs találat',
        noResultsHint: 'Próbálj más szűrési feltételeket használni',
        addToCart: 'Kosárba',
        addToCartFull: 'Kosárba helyezés',
        cart: 'Kosár',
        total: 'Összesen:',
        checkout: 'Megrendelés',
        emptyCart: 'A kosarad üres',
        toastAdded: (name) => `${name} hozzáadva a kosárhoz!`,
        toastEmpty: 'A kosarad üres!',
        toastOrder: (total) => `Rendelés elküldve! Összeg: ${total}`,
        orderSuccessToast: 'Rendelésed sikeresen leadtuk! Köszönjük a vásárlást!',
        alreadyInCart: 'Ez a cipő már a kosárban van!',
        shoesSoldOut: 'Néhány cipő időközben elkelt.',
        footer: 'BotiX © 2026 — Minden jog fenntartva. Minden termék eredeti.',
        styleCode: 'Stíluskód',
        sizeUS: 'US méret',
        sizeEUR: 'EUR méret',
        brand: 'Márka',
        type: 'Típus',
        gender: 'Nem',
        genderDisplay: { 'Férfi': 'Férfi', 'Női': 'Női', 'GS': 'GS/Youth' },
        sale: 'AKCIÓ',
        salePercent: (p) => `-${p}%`,
        login: 'Belépés',
        register: 'Regisztráció',
        password: 'Jelszó *',
        nameLabel: 'Név *',
        phoneLabel: 'Telefon',
        addressLabel: 'Irányítószám / Város',
        streetLabel: 'Utca, házszám',
        loginBtn: 'Belépés',
        registerBtn: 'Regisztráció',
        logout: 'Kijelentkezés',
        authErrorInvalid: 'Hibás email vagy jelszó!',
        authErrorExists: 'Ez az email már regisztrálva van!',
        authErrorGeneral: 'Hiba történt, próbáld újra!',
        registerSuccess: 'Ellenőrizd az email fiókodat az aktiváláshoz!',
        loginSuccess: 'Sikeres belépés!',
        logoutSuccess: 'Kijelentkezve!',
        accountNotActivated: 'A fiók nincs aktiválva. Ellenőrizd az emailjeidet!',
        accountActivated: 'Fiók aktiválva! Most már bejelentkezhetsz.',
        myAccount: 'Fiókom'
    },
    en: {
        searchPlaceholder: 'Search by model, color, size...',
        heroTitle: 'Step Up Your Level!',
        heroDesc: 'Authentic Nike, Jordan, Adidas and Vans sneakers. Every pair 100% original, boxed.',
        ribbonText: '100% Authentic',
        logoSlogan: 'Premium sneaker store',
        logoBadge: '100% Authentic',
        brandLabel: 'Brand:',
        typeLabel: 'Type:',
        genderLabel: 'Gender:',
        sizeLabel: 'EUR size:',
        all: 'All',
        men: 'Men',
        women: 'Women',
        gsYouth: 'GS/Youth',
        sortName: 'Name',
        sortPriceAsc: 'Price: low → high',
        sortPriceDesc: 'Price: high → low',
        sortSizeAsc: 'Size: small → large',
        sortSizeDesc: 'Size: large → small',
        resultsCount: (n) => `<strong>${n}</strong> products found`,
        noResults: 'No results',
        noResultsHint: 'Try different filter settings',
        addToCart: 'Add to cart',
        addToCartFull: 'Add to cart',
        cart: 'Cart',
        total: 'Total:',
        checkout: 'Checkout',
        emptyCart: 'Your cart is empty',
        toastAdded: (name) => `${name} added to cart!`,
        toastEmpty: 'Your cart is empty!',
        toastOrder: (total) => `Order submitted! Total: ${total}`,
        orderSuccessToast: 'Your order has been placed successfully! Thank you!',
        alreadyInCart: 'This shoe is already in your cart!',
        shoesSoldOut: 'Some shoes have been sold in the meantime.',
        footer: 'BotiX © 2026 — All rights reserved. Every product is authentic.',
        styleCode: 'Style Code',
        sizeUS: 'US Size',
        sizeEUR: 'EUR Size',
        brand: 'Brand',
        type: 'Type',
        gender: 'Gender',
        genderDisplay: { 'Férfi': 'Men', 'Női': 'Women', 'GS': 'GS/Youth' },
        sale: 'SALE',
        salePercent: (p) => `-${p}%`,
        login: 'Login',
        register: 'Register',
        password: 'Password *',
        nameLabel: 'Name *',
        phoneLabel: 'Phone',
        addressLabel: 'Zip Code / City',
        streetLabel: 'Street, number',
        loginBtn: 'Login',
        registerBtn: 'Register',
        logout: 'Logout',
        authErrorInvalid: 'Invalid email or password!',
        authErrorExists: 'This email is already registered!',
        authErrorGeneral: 'An error occurred, please try again!',
        registerSuccess: 'Please check your email to activate your account!',
        loginSuccess: 'Logged in successfully!',
        logoutSuccess: 'Logged out!',
        accountNotActivated: 'Account not activated. Please check your email!',
        accountActivated: 'Account activated! You can now log in.',
        myAccount: 'My Account'
    }
};

function t(key) { return i18n[currentLang][key]; }
function displayGender(g) { return t('genderDisplay')[g] || g; }

// ====== AUTH STATE ======
let currentUser = null;

// ====== STATE ======
let shoes = [];
let currentTheme = localStorage.getItem('sv-theme') || 'light';
let currentLang = localStorage.getItem('sv-lang') || 'hu';
let currentCurrency = localStorage.getItem('sv-currency') || 'HUF';
let activeFilters = { brand: 'all', type: 'all', gender: 'all', size: null };
let searchQuery = '';
let sortBy = 'name';
let cart = [];
let allSizes = [];

// ====== LOAD SHOES FROM API ======
async function loadShoes() {
    const res = await fetch('/api/shoes');
    shoes = await res.json();
    allSizes = [...new Set(shoes.map(s => s.sizeEUR))].sort((a, b) => a - b);
    refreshUI();
}

// ====== PRICE FORMATTING ======
function getEffectivePrice(shoe) {
    if (!shoe.onSale) return { huf: shoe.price, eur: shoe.priceEUR };
    if (shoe.saleType === 'FIXED') {
        return { huf: shoe.salePrice || shoe.price, eur: shoe.salePriceEUR || shoe.priceEUR };
    }
    if (shoe.saleType === 'PERCENTAGE' && shoe.salePercent) {
        return {
            huf: Math.round(shoe.price * (100 - shoe.salePercent) / 100),
            eur: Math.round(shoe.priceEUR * (100 - shoe.salePercent) / 100)
        };
    }
    return { huf: shoe.price, eur: shoe.priceEUR };
}

function formatPrice(shoe) {
    const eff = getEffectivePrice(shoe);
    if (shoe.onSale) {
        if (currentCurrency === 'EUR') {
            return `<span class="original-price"><span class="currency">€ </span>${shoe.priceEUR}</span><span class="sale-price"><span class="currency">€ </span>${eff.eur}</span>`;
        }
        return `<span class="original-price"><span class="currency">Ft </span>${shoe.price.toLocaleString('hu-HU')}</span><span class="sale-price"><span class="currency">Ft </span>${eff.huf.toLocaleString('hu-HU')}</span>`;
    }
    if (currentCurrency === 'EUR') {
        return `<span class="currency">€ </span>${shoe.priceEUR}`;
    }
    return `<span class="currency">Ft </span>${shoe.price.toLocaleString('hu-HU')}`;
}

function formatPriceModal(shoe) {
    const eff = getEffectivePrice(shoe);
    if (shoe.onSale) {
        if (currentCurrency === 'EUR') {
            return `<span class="original-price" style="font-size:20px"><span style="font-size:14px">€</span> ${shoe.priceEUR}</span> <span class="sale-price"><span style="font-size:18px">€</span> ${eff.eur}</span>`;
        }
        return `<span class="original-price" style="font-size:20px"><span style="font-size:14px">Ft</span> ${shoe.price.toLocaleString('hu-HU')}</span> <span class="sale-price"><span style="font-size:18px">Ft</span> ${eff.huf.toLocaleString('hu-HU')}</span>`;
    }
    if (currentCurrency === 'EUR') {
        return `<span style="font-size:18px">€</span> ${shoe.priceEUR}`;
    }
    return `<span style="font-size:18px">Ft</span> ${shoe.price.toLocaleString('hu-HU')}`;
}

function formatPriceCart(shoe) {
    const eff = getEffectivePrice(shoe);
    if (currentCurrency === 'EUR') return `€${eff.eur}`;
    return `${eff.huf.toLocaleString('hu-HU')} Ft`;
}

function formatTotal(items) {
    if (currentCurrency === 'EUR') {
        const total = items.reduce((sum, item) => sum + getEffectivePrice(item).eur, 0);
        return `€${total}`;
    }
    const total = items.reduce((sum, item) => sum + getEffectivePrice(item).huf, 0);
    return `${total.toLocaleString('hu-HU')} Ft`;
}

// ====== THEME ======
function applyTheme(theme) {
    currentTheme = theme;
    document.documentElement.setAttribute('data-theme', theme);
    localStorage.setItem('sv-theme', theme);
    updateToggleUI('themeToggle', theme);
}

function applyLang(lang) {
    currentLang = lang;
    document.documentElement.lang = lang === 'hu' ? 'hu' : 'en';
    document.title = lang === 'hu' ? 'BotiX - Premium Cipő Áruház' : 'BotiX - Premium Shoe Store';
    localStorage.setItem('sv-lang', lang);
    updateToggleUI('langToggle', lang);
    refreshUI();
}

function applyCurrency(curr) {
    currentCurrency = curr;
    localStorage.setItem('sv-currency', curr);
    updateToggleUI('currToggle', curr);
    refreshUI();
}

function updateToggleUI(groupId, activeVal) {
    document.querySelectorAll(`#${groupId} .toggle-opt`).forEach(btn => {
        btn.classList.toggle('active', btn.dataset.val === activeVal);
    });
}

function refreshUI() {
    document.getElementById('searchInput').placeholder = t('searchPlaceholder');
    document.getElementById('logoSlogan').textContent = t('logoSlogan');
    document.getElementById('logoBadge').textContent = t('logoBadge');
    document.getElementById('sloganText').textContent = t('heroTitle') + ' — ' + t('heroDesc');
    document.getElementById('footerText').textContent = t('footer');
    document.getElementById('cartTitle').textContent = t('cart');
    document.getElementById('cartTotalLabel').textContent = t('total');
    document.getElementById('checkoutBtn').textContent = t('checkout');
    document.getElementById('logoutBtn').textContent = t('logout');
    updateAuthUI();
    renderSortSelect();
    renderFilterRow();
    renderSizeFilters();
    renderProducts();
    updateCartUI();
}

function renderFilterRow() {
    const genderMap = { 'Férfi': t('men'), 'Női': t('women'), 'GS': t('gsYouth') };
    const row = document.getElementById('filterRow');
    row.innerHTML = `
        <span class="filter-label">${t('brandLabel')}</span>
        <div class="filter-group" id="brandFilters">
            <button class="filter-btn ${activeFilters.brand === 'all' ? 'active' : ''}" data-brand="all">${t('all')}</button>
            <button class="filter-btn ${activeFilters.brand === 'Jordan' ? 'active' : ''}" data-brand="Jordan">Jordan</button>
            <button class="filter-btn ${activeFilters.brand === 'Nike' ? 'active' : ''}" data-brand="Nike">Nike</button>
            <button class="filter-btn ${activeFilters.brand === 'Adidas' ? 'active' : ''}" data-brand="Adidas">Adidas</button>
            <button class="filter-btn ${activeFilters.brand === 'Vans' ? 'active' : ''}" data-brand="Vans">Vans</button>
        </div>
        <div class="filter-divider"></div>
        <span class="filter-label">${t('typeLabel')}</span>
        <div class="filter-group" id="typeFilters">
            <button class="filter-btn ${activeFilters.type === 'all' ? 'active' : ''}" data-type="all">${t('all')}</button>
            <button class="filter-btn ${activeFilters.type === 'High' ? 'active' : ''}" data-type="High">High</button>
            <button class="filter-btn ${activeFilters.type === 'Mid' ? 'active' : ''}" data-type="Mid">Mid</button>
            <button class="filter-btn ${activeFilters.type === 'Low' ? 'active' : ''}" data-type="Low">Low</button>
        </div>
        <div class="filter-divider"></div>
        <span class="filter-label">${t('genderLabel')}</span>
        <div class="filter-group" id="genderFilters">
            <button class="filter-btn ${activeFilters.gender === 'all' ? 'active' : ''}" data-gender="all">${t('all')}</button>
            <button class="filter-btn ${activeFilters.gender === 'Férfi' ? 'active' : ''}" data-gender="Férfi">${genderMap['Férfi']}</button>
            <button class="filter-btn ${activeFilters.gender === 'Női' ? 'active' : ''}" data-gender="Női">${genderMap['Női']}</button>
            <button class="filter-btn ${activeFilters.gender === 'GS' ? 'active' : ''}" data-gender="GS">${genderMap['GS']}</button>
        </div>
    `;

    document.querySelectorAll('#brandFilters .filter-btn').forEach(btn => {
        btn.onclick = () => { activeFilters.brand = btn.dataset.brand; renderFilterRow(); renderProducts(); };
    });
    document.querySelectorAll('#typeFilters .filter-btn').forEach(btn => {
        btn.onclick = () => { activeFilters.type = btn.dataset.type; renderFilterRow(); renderProducts(); };
    });
    document.querySelectorAll('#genderFilters .filter-btn').forEach(btn => {
        btn.onclick = () => { activeFilters.gender = btn.dataset.gender; renderFilterRow(); renderProducts(); };
    });
}

function renderSortSelect() {
    const sel = document.getElementById('sortSelect');
    sel.innerHTML = `
        <option value="name">${t('sortName')}</option>
        <option value="price-asc">${t('sortPriceAsc')}</option>
        <option value="price-desc">${t('sortPriceDesc')}</option>
        <option value="size-asc">${t('sortSizeAsc')}</option>
        <option value="size-desc">${t('sortSizeDesc')}</option>
    `;
    sel.value = sortBy;
}

function renderSizeFilters() {
    const container = document.getElementById('sizeFilters');
    container.innerHTML = `<span class="filter-label" style="margin-right:4px">${t('sizeLabel')}</span>`;
    allSizes.forEach(size => {
        const btn = document.createElement('button');
        btn.className = 'size-btn' + (activeFilters.size === size ? ' active' : '');
        btn.textContent = size;
        btn.dataset.size = size;
        btn.onclick = () => {
            activeFilters.size = activeFilters.size === size ? null : size;
            renderSizeFilters();
            renderProducts();
        };
        container.appendChild(btn);
    });
}

// ====== AUTH ======
async function initAuth() {
    const token = localStorage.getItem('sv-auth-token');
    if (!token) return;

    try {
        const res = await fetch('/api/customers/me', {
            headers: { 'Authorization': 'Bearer ' + token }
        });
        if (res.ok) {
            currentUser = await res.json();
            updateAuthUI();
        } else {
            localStorage.removeItem('sv-auth-token');
        }
    } catch (e) {
        // silent fail
    }
}

function updateAuthUI() {
    const nameEl = document.getElementById('authName');
    const emailEl = document.getElementById('userEmail');
    const accountLink = document.getElementById('myAccountLink');

    if (currentUser) {
        nameEl.textContent = currentUser.name || currentUser.email;
        nameEl.style.display = 'inline';
        emailEl.textContent = currentUser.email;
        accountLink.textContent = t('myAccount');
        accountLink.style.display = 'block';
    } else {
        nameEl.style.display = 'none';
        accountLink.style.display = 'none';
    }
}

function handleAuthClick() {
    if (currentUser) {
        document.getElementById('userDropdown').classList.toggle('show');
    } else {
        openAuthModal();
    }
}

function openAuthModal() {
    const modal = document.getElementById('authModal');
    modal.classList.add('show');
    document.body.style.overflow = 'hidden';
    switchAuthTab('login');
    document.getElementById('authError').classList.remove('show');
    // Update auth modal labels
    document.getElementById('authTabLogin').textContent = t('login');
    document.getElementById('authTabRegister').textContent = t('register');
    document.getElementById('loginPassLabel').textContent = t('password');
    document.getElementById('loginSubmitBtn').textContent = t('loginBtn');
    document.getElementById('regPassLabel').textContent = t('password');
    document.getElementById('regNameLabel').textContent = t('nameLabel');
    document.getElementById('regPhoneLabel').textContent = t('phoneLabel');
    document.getElementById('regAddressLabel').textContent = t('addressLabel');
    document.getElementById('regStreetLabel').textContent = t('streetLabel');
    document.getElementById('regSubmitBtn').textContent = t('registerBtn');
}

function closeAuthModal() {
    document.getElementById('authModal').classList.remove('show');
    document.body.style.overflow = '';
}

function switchAuthTab(tab) {
    document.querySelectorAll('.auth-tab').forEach(b => b.classList.toggle('active', b.dataset.auth === tab));
    document.getElementById('loginForm').classList.toggle('active', tab === 'login');
    document.getElementById('registerForm').classList.toggle('active', tab === 'register');
    document.getElementById('authError').classList.remove('show');
}

async function doLogin(e) {
    e.preventDefault();
    const email = document.getElementById('loginEmail').value;
    const password = document.getElementById('loginPassword').value;
    const errEl = document.getElementById('authError');
    errEl.classList.remove('show');

    try {
        const res = await fetch('/api/customers/login', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({ email, password })
        });

        if (res.ok) {
            const data = await res.json();
            localStorage.setItem('sv-auth-token', data.token);
            currentUser = data;
            updateAuthUI();
            closeAuthModal();
            showToast(t('loginSuccess'));
            document.getElementById('loginForm').reset();
        } else if (res.status === 403) {
            errEl.textContent = t('accountNotActivated');
            errEl.classList.add('show');
        } else {
            errEl.textContent = t('authErrorInvalid');
            errEl.classList.add('show');
        }
    } catch (err) {
        errEl.textContent = t('authErrorGeneral');
        errEl.classList.add('show');
    }
}

async function doRegister(e) {
    e.preventDefault();
    const errEl = document.getElementById('authError');
    errEl.classList.remove('show');

    const body = {
        email: document.getElementById('regEmail').value,
        password: document.getElementById('regPassword').value,
        name: document.getElementById('regName').value,
        phone: document.getElementById('regPhone').value,
        zip: document.getElementById('regZip').value,
        city: document.getElementById('regCity').value,
        street: document.getElementById('regStreet').value,
        baseUrl: window.location.origin
    };

    try {
        const res = await fetch('/api/customers/register', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify(body)
        });

        if (res.ok) {
            closeAuthModal();
            showToast(t('registerSuccess'));
            document.getElementById('registerForm').reset();
        } else if (res.status === 409) {
            errEl.textContent = t('authErrorExists');
            errEl.classList.add('show');
        } else {
            errEl.textContent = t('authErrorGeneral');
            errEl.classList.add('show');
        }
    } catch (err) {
        errEl.textContent = t('authErrorGeneral');
        errEl.classList.add('show');
    }
}

async function doLogout() {
    const token = localStorage.getItem('sv-auth-token');
    if (token) {
        try {
            await fetch('/api/customers/logout', {
                method: 'POST',
                headers: { 'Authorization': 'Bearer ' + token }
            });
        } catch (e) {}
    }
    localStorage.removeItem('sv-auth-token');
    currentUser = null;
    document.getElementById('userDropdown').classList.remove('show');
    updateAuthUI();
    showToast(t('logoutSuccess'));
}

function init() {
    applyTheme(currentTheme);
    updateToggleUI('langToggle', currentLang);
    updateToggleUI('currToggle', currentCurrency);

    document.querySelectorAll('#themeToggle .toggle-opt').forEach(btn => {
        btn.onclick = () => applyTheme(btn.dataset.val);
    });
    document.querySelectorAll('#langToggle .toggle-opt').forEach(btn => {
        btn.onclick = () => applyLang(btn.dataset.val);
    });
    document.querySelectorAll('#currToggle .toggle-opt').forEach(btn => {
        btn.onclick = () => applyCurrency(btn.dataset.val);
    });

    document.getElementById('searchInput').addEventListener('input', (e) => {
        searchQuery = e.target.value.toLowerCase();
        renderProducts();
    });

    document.getElementById('sortSelect').addEventListener('change', (e) => {
        sortBy = e.target.value;
        renderProducts();
    });

    document.getElementById('productModal').addEventListener('click', (e) => {
        if (e.target === e.currentTarget) closeModal();
    });

    document.addEventListener('keydown', (e) => {
        if (e.key === 'Escape') { closeModal(); closeAuthModal(); if (document.getElementById('cartDrawer').classList.contains('open')) toggleCart(); }
    });

    document.getElementById('authModal').addEventListener('click', (e) => {
        if (e.target === e.currentTarget) closeAuthModal();
    });

    document.querySelectorAll('.auth-tab').forEach(btn => {
        btn.onclick = () => switchAuthTab(btn.dataset.auth);
    });

    // Close user dropdown on outside click
    document.addEventListener('click', (e) => {
        const menu = document.getElementById('userMenu');
        if (!menu.contains(e.target)) {
            document.getElementById('userDropdown').classList.remove('show');
        }
    });

    initAuth();

    // Handle activation redirect
    const urlParams = new URLSearchParams(window.location.search);
    if (urlParams.get('activated') === 'true') {
        showToast(t('accountActivated'));
        window.history.replaceState({}, '', window.location.pathname);
    }

    if (localStorage.getItem('sv-checkout-success')) {
        localStorage.removeItem('sv-checkout-success');
        cart = [];
        updateCartUI();
        loadShoes().then(() => {
            showToast(t('orderSuccessToast'));
        });
    } else {
        loadShoes();
    }
}

function getFilteredProducts() {
    let filtered = shoes.filter(shoe => {
        if (activeFilters.brand !== 'all' && shoe.brand !== activeFilters.brand) return false;
        if (activeFilters.type !== 'all' && shoe.type !== activeFilters.type) return false;
        if (activeFilters.gender !== 'all' && shoe.gender !== activeFilters.gender) return false;
        if (activeFilters.size !== null && shoe.sizeEUR !== activeFilters.size) return false;
        if (searchQuery) {
            const haystack = `${shoe.name} ${shoe.color} ${shoe.styleCode} ${shoe.sizeUS} ${shoe.sizeEUR} ${shoe.brand} ${shoe.type} ${shoe.gender}`.toLowerCase();
            return haystack.includes(searchQuery);
        }
        return true;
    });

    switch (sortBy) {
        case 'price-asc': filtered.sort((a, b) => currentCurrency === 'EUR' ? getEffectivePrice(a).eur - getEffectivePrice(b).eur : getEffectivePrice(a).huf - getEffectivePrice(b).huf); break;
        case 'price-desc': filtered.sort((a, b) => currentCurrency === 'EUR' ? getEffectivePrice(b).eur - getEffectivePrice(a).eur : getEffectivePrice(b).huf - getEffectivePrice(a).huf); break;
        case 'size-asc': filtered.sort((a, b) => a.sizeEUR - b.sizeEUR); break;
        case 'size-desc': filtered.sort((a, b) => b.sizeEUR - a.sizeEUR); break;
        default:
            filtered.sort((a, b) => {
                const aS = a.onSale ? 0 : 1;
                const bS = b.onSale ? 0 : 1;
                if (aS !== bS) return aS - bS;
                return a.name.localeCompare(b.name);
            });
    }

    return filtered;
}

function renderProducts() {
    const grid = document.getElementById('productsGrid');
    const products = getFilteredProducts();

    document.getElementById('resultsCount').innerHTML = t('resultsCount')(products.length);

    if (products.length === 0) {
        grid.innerHTML = `<div class="no-results"><h3>${t('noResults')}</h3><p>${t('noResultsHint')}</p></div>`;
        return;
    }

    grid.innerHTML = products.map(shoe => `
        <div class="product-card" onclick="openModal(${shoe.id})">
            <div class="product-image">
                <img src="${shoe.imageUrl || ''}" alt="${shoe.name} ${shoe.color}" loading="lazy">
                <span class="brand-badge ${shoe.brand.toLowerCase()}">${shoe.brand}</span>
                <span class="type-badge">${shoe.type}</span>
                ${shoe.onSale ? `<span class="sale-badge">${t('sale')}</span>` : ''}
                ${shoe.onSale && shoe.saleType === 'PERCENTAGE' && shoe.salePercent ? `<span class="sale-percent-badge">${t('salePercent')(shoe.salePercent)}</span>` : ''}
            </div>
            <div class="product-info">
                <div class="product-name">${shoe.name}${shoe.variant ? ` (${shoe.variant})` : ''}</div>
                <div class="product-colorway">${shoe.color}</div>
                <div class="product-meta">
                    <span class="meta-tag">US ${shoe.sizeUS}</span>
                    <span class="meta-tag">EUR ${shoe.sizeEUR}</span>
                    <span class="meta-tag">${displayGender(shoe.gender)}</span>
                </div>
                <div class="product-bottom">
                    <div class="product-price">${formatPrice(shoe)}</div>
                    <button class="add-to-cart" onclick="event.stopPropagation(); addToCart(${shoe.id})">${t('addToCart')}</button>
                </div>
            </div>
        </div>
    `).join('');
}

let galleryImages = [];
let galleryIndex = 0;

function openModal(id) {
    const shoe = shoes.find(s => s.id === id);
    if (!shoe) return;

    let sid = sessionStorage.getItem('_bx_sid');
    if (!sid) { sid = Math.random().toString(36).substr(2); sessionStorage.setItem('_bx_sid', sid); }
    navigator.sendBeacon('/api/analytics/click', new Blob([JSON.stringify({ shoeId: id, sessionId: sid })], {type:'application/json'}));

    const hasGallery = shoe.images && shoe.images.length > 1;
    galleryImages = hasGallery ? shoe.images : [];
    galleryIndex = 0;

    let imageSection;
    if (hasGallery) {
        imageSection = `
            <div class="modal-gallery">
                <div class="gallery-main">
                    <button class="gallery-nav prev" onclick="galleryNav(-1)">&#8249;</button>
                    <img id="galleryMainImg" src="${shoe.images[0].imageUrl}" alt="${shoe.name} ${shoe.color}">
                    <button class="gallery-nav next" onclick="galleryNav(1)">&#8250;</button>
                </div>
                <div class="gallery-thumbs" id="galleryThumbs">
                    ${shoe.images.map((img, i) => `
                        <div class="gallery-thumb ${i === 0 ? 'active' : ''}" onclick="galleryGoTo(${i})">
                            <img src="${img.imageUrl}" alt="">
                        </div>
                    `).join('')}
                </div>
            </div>`;
    } else {
        imageSection = `
            <div class="modal-image">
                <img src="${shoe.imageUrl || ''}" alt="${shoe.name} ${shoe.color}">
            </div>`;
    }

    const modal = document.getElementById('modalContent');
    modal.innerHTML = `
        <button class="modal-close" onclick="closeModal()">&times;</button>
        ${imageSection}
        <div class="modal-body">
            <h2>${shoe.name}${shoe.variant ? ` (${shoe.variant})` : ''}</h2>
            <div class="colorway">${shoe.color}</div>
            <div class="modal-details">
                <div class="detail-item"><label>${t('styleCode')}</label><span>${shoe.styleCode}</span></div>
                <div class="detail-item"><label>${t('sizeUS')}</label><span>${shoe.sizeUS}</span></div>
                <div class="detail-item"><label>${t('sizeEUR')}</label><span>${shoe.sizeEUR}</span></div>
                <div class="detail-item"><label>${t('brand')}</label><span>${shoe.brand}</span></div>
                <div class="detail-item"><label>${t('type')}</label><span>${shoe.type}</span></div>
                <div class="detail-item"><label>${t('gender')}</label><span>${displayGender(shoe.gender)}</span></div>
            </div>
            ${shoe.onSale ? `<div style="margin-bottom:8px"><span style="display:inline-block;background:#e53e3e;color:white;padding:4px 12px;border-radius:6px;font-size:13px;font-weight:700">${t('sale')}${shoe.saleType === 'PERCENTAGE' && shoe.salePercent ? ' ' + t('salePercent')(shoe.salePercent) : ''}</span></div>` : ''}
            <div class="modal-price">${formatPriceModal(shoe)}</div>
            <button class="modal-add-btn" onclick="addToCart(${shoe.id}); closeModal();">${t('addToCartFull')}</button>
        </div>
    `;

    document.getElementById('productModal').classList.add('show');
    document.body.style.overflow = 'hidden';
}

function galleryNav(delta) {
    if (galleryImages.length === 0) return;
    galleryIndex = (galleryIndex + delta + galleryImages.length) % galleryImages.length;
    updateGallery();
}

function galleryGoTo(index) {
    galleryIndex = index;
    updateGallery();
}

function updateGallery() {
    const mainImg = document.getElementById('galleryMainImg');
    if (mainImg) mainImg.src = galleryImages[galleryIndex].imageUrl;

    const thumbs = document.querySelectorAll('#galleryThumbs .gallery-thumb');
    thumbs.forEach((thumb, i) => {
        thumb.classList.toggle('active', i === galleryIndex);
    });
}

function closeModal() {
    document.getElementById('productModal').classList.remove('show');
    document.body.style.overflow = '';
}

function addToCart(id) {
    const shoe = shoes.find(s => s.id === id);
    if (!shoe) return;
    if (cart.some(item => item.id === id)) {
        showToast(t('alreadyInCart'));
        return;
    }
    cart.push({ ...shoe, cartId: Date.now() + Math.random() });
    updateCartUI();
    showToast(t('toastAdded')(shoe.name));
}

function removeFromCart(cartId) {
    cart = cart.filter(item => item.cartId !== cartId);
    updateCartUI();
}

function updateCartUI() {
    const countEl = document.getElementById('cartCount');
    const itemsEl = document.getElementById('cartItems');
    const totalEl = document.getElementById('cartTotal');

    countEl.textContent = cart.length;
    countEl.style.display = cart.length > 0 ? 'flex' : 'none';

    totalEl.textContent = formatTotal(cart);

    if (cart.length === 0) {
        itemsEl.innerHTML = `<div class="cart-empty">${t('emptyCart')}</div>`;
        return;
    }

    itemsEl.innerHTML = cart.map(item => `
        <div class="cart-item">
            <div class="cart-item-img">
                <img src="${item.imageUrl || ''}" alt="${item.name}">
            </div>
            <div class="cart-item-info">
                <h4>${item.name}</h4>
                <div class="ci-size">EUR ${item.sizeEUR} | US ${item.sizeUS}</div>
                <div class="ci-price">${formatPriceCart(item)}</div>
            </div>
            <button class="cart-item-remove" onclick="removeFromCart(${item.cartId})">&times;</button>
        </div>
    `).join('');
}

function toggleCart() {
    document.getElementById('cartOverlay').classList.toggle('show');
    document.getElementById('cartDrawer').classList.toggle('open');
}

function checkout() {
    if (cart.length === 0) {
        showToast(t('toastEmpty'));
        return;
    }

    localStorage.setItem('sv-cart', JSON.stringify(cart));
    window.location.href = 'checkout.html';
}

function showToast(msg) {
    const toast = document.getElementById('toast');
    toast.textContent = msg;
    toast.classList.add('show');
    setTimeout(() => toast.classList.remove('show'), 2500);
}

init();

// ====== ANALYTICS TRACKING ======
(function(){
    let sid = sessionStorage.getItem('_bx_sid');
    if (!sid) { sid = Math.random().toString(36).substr(2); sessionStorage.setItem('_bx_sid', sid); }
    navigator.sendBeacon('/api/analytics/track', new Blob([JSON.stringify({
        url: location.pathname, referrer: document.referrer, userAgent: navigator.userAgent, sessionId: sid
    })], {type:'application/json'}));
})();
</script>
</body>
</html>
